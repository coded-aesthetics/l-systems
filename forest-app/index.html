<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>L-System Forest Generator</title>
        <link rel="stylesheet" href="./src/styles/main.css" />
    </head>
    <body>
        <div class="header">
            <h1>üå≤ L-System Forest Generator</h1>
        </div>

        <div class="main-container">
            <div class="controls-panel">
                <div class="control-section">
                    <h3>Available Plants</h3>
                    <div id="plants-list">
                        <div class="loading">Loading plants...</div>
                    </div>
                    <button id="refresh-plants-btn">Refresh Plants</button>
                </div>

                <div class="control-section">
                    <h3>Forest Parameters</h3>
                    <label>Plant Count:</label>
                    <div class="input-row">
                        <input
                            type="range"
                            id="plantCount"
                            min="10"
                            max="5000"
                            value="900"
                        />
                        <span id="plantCount-value" class="value-display"
                            >900</span
                        >
                    </div>

                    <label>Forest Size (units):</label>
                    <div class="input-row">
                        <input
                            type="range"
                            id="forestSize"
                            min="10"
                            max="1000"
                            value="400"
                        />
                        <span id="forestSize-value" class="value-display"
                            >400</span
                        >
                    </div>

                    <label>Minimum Distance Between Plants:</label>
                    <div class="input-row">
                        <input
                            type="range"
                            id="minDistance"
                            min="1"
                            max="20"
                            value="5"
                        />
                        <span id="minDistance-value" class="value-display"
                            >5</span
                        >
                    </div>

                    <label>Plant Scale Variation:</label>
                    <div class="input-row">
                        <input
                            type="range"
                            id="scaleVariation"
                            min="0"
                            max="100"
                            value="30"
                        />
                        <span id="scaleVariation-value" class="value-display"
                            >30%</span
                        >
                    </div>

                    <label>Terrain Height Variation (Legacy):</label>
                    <div class="input-row">
                        <input
                            type="range"
                            id="terrainHeight"
                            min="0"
                            max="2000"
                            value="5"
                        />
                        <span id="terrainHeight-value" class="value-display"
                            >5</span
                        >
                    </div>
                </div>

                <div class="control-section">
                    <h3>üèîÔ∏è Terrain Configuration</h3>
                    <label>Terrain Type:</label>
                    <div class="input-row">
                        <select
                            id="terrainType"
                            onchange="setTerrainType(this.value)"
                            style="width: 100%; padding: 5px"
                        >
                            <option value="flat">üèûÔ∏è Flat</option>
                            <option value="rolling" selected>
                                üåÑ Rolling Hills
                            </option>
                            <option value="hilly">‚õ∞Ô∏è Hilly</option>
                            <option value="mountainous">üèîÔ∏è Mountainous</option>
                        </select>
                    </div>

                    <label>Height Variation:</label>
                    <div class="input-row">
                        <input
                            type="range"
                            id="terrainHeightVariation"
                            min="0"
                            max="10"
                            step="0.5"
                            value="2"
                            oninput="updateTerrainHeightVariation(this.value)"
                        />
                        <span
                            id="terrainHeightVariation-value"
                            class="value-display"
                            >2</span
                        >
                    </div>

                    <label>Terrain Color:</label>
                    <div class="input-row">
                        <input
                            type="color"
                            id="terrainColor"
                            value="#228b22"
                            onchange="updateTerrainColor(this.value)"
                            style="
                                width: 50px;
                                height: 30px;
                                border: none;
                                border-radius: 3px;
                                cursor: pointer;
                            "
                        />
                        <button
                            onclick="regenerateTerrain()"
                            style="
                                margin-left: 10px;
                                padding: 8px 15px;
                                background: #4caf50;
                                color: white;
                                border: none;
                                border-radius: 3px;
                                cursor: pointer;
                                font-weight: bold;
                            "
                        >
                            üîÑ Regenerate
                        </button>
                    </div>

                    <div class="input-row" style="margin-top: 10px">
                        <button
                            onclick="applyTerrainPreset('COUNTRYSIDE')"
                            style="
                                margin-right: 5px;
                                padding: 5px 8px;
                                background: #8fbc8f;
                                color: white;
                                border: none;
                                border-radius: 3px;
                                cursor: pointer;
                                font-size: 12px;
                            "
                        >
                            Countryside
                        </button>
                        <button
                            onclick="applyTerrainPreset('ALPINE')"
                            style="
                                margin-right: 5px;
                                padding: 5px 8px;
                                background: #708090;
                                color: white;
                                border: none;
                                border-radius: 3px;
                                cursor: pointer;
                                font-size: 12px;
                            "
                        >
                            Alpine
                        </button>
                        <button
                            onclick="applyTerrainPreset('FOREST_FLOOR')"
                            style="
                                padding: 5px 8px;
                                background: #556b2f;
                                color: white;
                                border: none;
                                border-radius: 3px;
                                cursor: pointer;
                                font-size: 12px;
                            "
                        >
                            Forest Floor
                        </button>
                    </div>
                </div>

                <div class="control-section">
                    <h3>Day/Night Cycle</h3>
                    <label>Day Duration (minutes):</label>
                    <div class="input-row">
                        <input
                            type="range"
                            id="dayDuration"
                            min="0.5"
                            max="10"
                            step="0.5"
                            value="2"
                        />
                        <span class="value-display" id="dayDuration-value"
                            >2 min</span
                        >
                    </div>

                    <label>Time Speed:</label>
                    <div class="input-row">
                        <input
                            type="range"
                            id="timeSpeed"
                            min="0.1"
                            max="5"
                            step="0.1"
                            value="1"
                        />
                        <span class="value-display" id="timeSpeed-value"
                            >1x</span
                        >
                    </div>

                    <label>
                        <input type="checkbox" id="pauseTime" />
                        Pause Time
                    </label>
                </div>

                <button class="generate-btn" id="generateBtn">
                    Generate Forest
                </button>
                <button id="clear-forest-btn">Clear Forest</button>
                <button id="export-forest-btn">Export Scene</button>
                <button id="help-btn">Help</button>
            </div>

            <div class="canvas-container">
                <canvas id="forest-canvas"></canvas>
                <div class="loading" id="generation-loading">
                    Generating forest...
                </div>
                <div
                    id="fly-mode-indicator"
                    style="
                        position: absolute;
                        top: 10px;
                        left: 10px;
                        color: white;
                        font-weight: bold;
                        background: rgba(0, 0, 0, 0.7);
                        padding: 5px 10px;
                        border-radius: 5px;
                        z-index: 1000;
                    "
                >
                    WALK MODE
                </div>
                <div
                    id="flashlight-indicator"
                    style="
                        position: absolute;
                        top: 80px;
                        left: 10px;
                        color: white;
                        font-weight: bold;
                        background: rgba(0, 0, 0, 0.7);
                        padding: 5px 10px;
                        border-radius: 5px;
                        z-index: 1000;
                        display: none;
                    "
                >
                    üî¶ FLASHLIGHT ON
                </div>
                <div
                    id="tutorial-popup"
                    style="
                        position: absolute;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%);
                        background: rgba(0, 0, 0, 0.9);
                        color: white;
                        padding: 20px;
                        border-radius: 10px;
                        z-index: 2000;
                        max-width: 400px;
                        text-align: center;
                        font-family: Arial, sans-serif;
                        border: 2px solid #00ff00;
                        display: none;
                    "
                >
                    <h3>üå≤ Forest Explorer Controls üå≤</h3>
                    <div style="text-align: left; margin: 15px 0">
                        <strong>Movement:</strong><br />
                        ‚Ä¢ WASD - Walk around<br />
                        ‚Ä¢ Mouse - Look around<br />
                        ‚Ä¢ Shift - Hold to run (uses stamina)<br />
                        ‚Ä¢ Space - Jump<br /><br />

                        <strong>Modes:</strong><br />
                        ‚Ä¢ F - Toggle Fly Mode<br />
                        ‚Ä¢ C - Move down (fly mode only)<br /><br />

                        <strong>Flashlight:</strong><br />
                        ‚Ä¢ L - Toggle flashlight on/off<br />
                        ‚Ä¢ Perfect for night and fog!<br />
                        ‚Ä¢ Tab - Toggle fullscreen mode<br /><br />

                        <strong>Tips:</strong><br />
                        ‚Ä¢ Watch your stamina bar!<br />
                        ‚Ä¢ Green stamina = full energy<br />
                        ‚Ä¢ Red stamina = tired<br />
                        ‚Ä¢ Use flashlight in heavy fog<br />
                        ‚Ä¢ Press ESC to exit fullscreen<br />
                    </div>
                    <button
                        id="tutorial-close-btn"
                        style="
                            background: #00ff00;
                            color: black;
                            border: none;
                            padding: 10px 20px;
                            border-radius: 5px;
                            cursor: pointer;
                            font-weight: bold;
                        "
                    >
                        Got it!
                    </button>
                </div>
                <div
                    id="stamina-bar"
                    style="
                        position: absolute;
                        top: 50px;
                        left: 10px;
                        width: 150px;
                        height: 15px;
                        background: rgba(0, 0, 0, 0.7);
                        border: 2px solid white;
                        border-radius: 8px;
                        z-index: 1000;
                        overflow: hidden;
                    "
                >
                    <div
                        id="stamina-fill"
                        style="
                            height: 100%;
                            width: 100%;
                            background: linear-gradient(
                                90deg,
                                #00ff00,
                                #ffff00,
                                #ff0000
                            );
                            transition: width 0.2s ease;
                        "
                    ></div>
                </div>
            </div>
        </div>

        <div class="stats" id="stats">
            <strong>Forest Stats:</strong><br />
            Plants: <span id="plant-count">0</span><br />
            Triangles: <span id="triangle-count">0</span><br />
            FPS: <span id="fps-count">0</span><br />
            Time: <span id="time-display">12:00</span> (<span
                id="period-display"
                >Day</span
            >)<br />
            Weather: <span id="fog-status">Clear</span><br />
            Terrain: <span id="terrain-type">Rolling</span> (<span
                id="terrain-triangles"
                >20,000</span
            >
            triangles)
        </div>

        <div class="fullscreen-indicator" id="fullscreen-indicator">
            FULLSCREEN MODE - Press ESC to exit
        </div>

        <script type="module" src="./src/main.ts"></script>
    </body>
</html>
